## 复制
在分布式系统中为了解决单点问题，通常会把数据复制多个副本部署到其他机器，
满足故障恢复和负载均衡等需求。Redis也是如此，提供了复制功能，实现了相同数据
的多个Redis副本，复制是Redis高可用的基础

### 配置
#### 建立复制
参与复制的Redis分为直接点和从节点。默认情况下Redis都是主节点。每个从节点
只能有一个主节点，每个主节点可以有多个从节点。复制的数据流是单向的，只能由
主节点复制到从节点。配置的方式有三种
1. 配置文件中加入slaveof {masterHost} {masterPort}<br>
    后续版本为replicaof {masterHost} {masterPort}
2. 在redis-server启动命令后加入slaveof {masterHost} {masterPort}
3. 直接使用命令 slaveof {masterHost} {masterPort}

#### 断开复制
在从节点执行slaveof no one<br>
还可以实现切主操作，直接salveof newip new port，切主流程如下：
1. 断开与旧主节点的复制关系
2. 与新主节点建立复制关系
3. 删除从节点当前所有数据
4. 对新主节点进行复制操作

*需要注意，小心slaveof在错误的节点上执行或指向错误的主节点

#### 只读
默认情况下从节点使用slave-read-only=yes配置为只读模式。
由于复制只能从主节点到从节点，所以修改从节点只读会造成主从数据不一致。
因此建议生产环境不要修改从节点的只读属性

#### 传输延迟
主从节点一般部署在不同机器上，复制时需要考虑网络延迟，Redis提供了
repl-disable-tcp-nodelay参数用于控制是否关闭TCP_NODELAY，默认关闭
- 关闭时，主节点产生的命令数据无论大小都会及时地发送给从节点，这样
  主从之间延迟会变小，但增加了网络带宽消耗。适用于主从之间网络良好的情况
- 开启时，主节点会合并较小的TCP数据包从而节省带宽。默认发送时间间隔取决于
  Linux的内核，一般默认为40毫秒。适用于网络环境复杂或带宽紧张的场景
  
### 拓扑
- 一主一从
- 一主多从
- 树形主从